import{r as n,j as e}from"./vendor-ui-CN8WKm1l.js";import{c as k,H as Y,d as y,T as ee,e as se,F as te}from"./index-gDkUcazU.js";import{C as ae,a as re,b as ne,c as le}from"./card-BTQvvDTQ.js";import{S as D,a as P,b as F,c as H,d as i}from"./select-DoADUCMx.js";import{T as ce,a as oe,b}from"./tabs-CCYxO0HW.js";import{C as U}from"./clock-BcG_Vx7t.js";import{A as ie}from"./AstroType-DTyWrezA.js";import{g as de}from"./typingPassages-CNQ9HsTr.js";import{g as me,a as xe}from"./typingCodeSnippets-BbnfeOjw.js";import{a as pe}from"./vendor-react-Bte3Nn5F.js";import{A as he}from"./arrow-left-Cpu3jsbt.js";import{R as ue}from"./rotate-ccw-DZQtxq7N.js";import{Z as ge}from"./zap-D4hAHzvK.js";const fe=k("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);const je=k("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const ye=k("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const we=k("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);function ve(){const[w,t]=n.useState(()=>new Date);n.useEffect(()=>{const S=setInterval(()=>t(new Date),1e3);return()=>clearInterval(S)},[]);const C=w.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),d=w.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return e.jsxs("div",{className:"flex items-center gap-2 rounded-md border bg-muted/30 px-3 py-1.5 font-mono text-sm",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx("span",{className:"tabular-nums",children:C}),e.jsx("span",{className:"text-muted-foreground text-xs hidden sm:inline",children:d})]})}const Ne=["javascript","python","sql"];function Pe(){const w=pe(),[t,C]=n.useState("code"),[d,S]=n.useState("medium"),[h,J]=n.useState("javascript"),[u,Q]=n.useState("javascript"),[c,W]=n.useState(""),[l,g]=n.useState(""),[m,T]=n.useState(null),[B,L]=n.useState(null),[v,M]=n.useState(!1),[V,E]=n.useState(new Set),x=n.useRef(null),A=n.useCallback(()=>{W(de(d)),g(""),T(null),L(null),M(!1),E(new Set),setTimeout(()=>x.current?.focus(),100)},[d]),N=n.useCallback(()=>{W(me(t==="challenge"?u:h)),g(""),T(null),L(null),M(!1),E(new Set),setTimeout(()=>x.current?.focus(),100)},[h,t,u]);n.useEffect(()=>{t==="text"?A():(t==="code"||t==="challenge")&&N()},[t,d,h,u]),n.useEffect(()=>{!c||c.length===0||(l.length===1&&!m&&T(Date.now()),E(s=>{const a=new Set(s),r=l.length-1;return r>=0&&r<c.length&&(l[r]!==c[r]?a.add(r):a.delete(r)),a}),l.length>=c.length&&c.length>0&&(M(!0),L(Date.now())))},[l,c]);const I=m?(Date.now()-m)/1e3:0,$=I/60,G=c.slice(0,l.length).split("").filter((s,a)=>s===l[a]).length,q=l.length,R=q>0?Math.round(G/q*100):100,z=$>0?Math.round(G/5/$):0,p=t==="code"||t==="challenge",Z=t==="challenge"?u:h,K=s=>{if(s.key==="Tab"){s.preventDefault();const a=s.currentTarget,r=a.selectionStart??0,o=a.selectionEnd??r,f=l.slice(0,r)+"  "+l.slice(o);g(f),setTimeout(()=>a.setSelectionRange(r+2,r+2),0)}},_=p&&c?xe(c,Z):[],O=n.useMemo(()=>{if(!c.length||t!=="challenge")return[];const s=Math.max(1,Math.ceil(c.length/20)),a=new Array(20).fill(0);return V.forEach(r=>{const o=Math.min(19,Math.floor(r/s));a[o]++}),a},[c.length,V,t]),X=Math.max(1,...O);return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(Y,{}),t==="astrotype"?e.jsx("main",{className:"flex-1 pt-16",children:e.jsx(ie,{})}):e.jsx("main",{className:"flex-1 container max-w-4xl mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>w(-1),"aria-label":"Go back",children:e.jsx(he,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Type Forge"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t==="challenge"?"Code Typing Challenge: syntax accuracy, time-to-complete, error heatmap. For engineers & bootcamp learners.":t==="code"?"Practice typing code with syntax highlighting. Timer starts on first keypress.":"Type the passage below. WPM is based on correct characters."})]})}),e.jsx("div",{className:"w-10 shrink-0","aria-hidden":!0})]}),e.jsx(ce,{value:t,onValueChange:s=>C(s),children:e.jsxs(oe,{className:"grid w-full max-w-lg grid-cols-4 mx-auto",children:[e.jsxs(b,{value:"code",className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Code"]}),e.jsxs(b,{value:"challenge",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Challenge"]}),e.jsxs(b,{value:"text",className:"gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Text"]}),e.jsxs(b,{value:"astrotype",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"AstroType"]})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[(t==="code"||t==="challenge")&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{}),t==="code"&&e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>window.dispatchEvent(new CustomEvent("open-chatbot")),className:"gap-2","aria-label":"Open AI assistant",children:[e.jsx(se,{className:"h-4 w-4 text-primary"}),"AI"]})]}),t==="challenge"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Language:"}),e.jsxs(D,{value:u,onValueChange:s=>Q(s),children:[e.jsx(P,{className:"w-[130px]",children:e.jsx(F,{})}),e.jsx(H,{children:Ne.map(s=>e.jsx(i,{value:s,children:s==="javascript"?"JavaScript":s==="python"?"Python":"SQL"},s))})]})]}):t==="code"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Language:"}),e.jsxs(D,{value:h,onValueChange:s=>J(s),children:[e.jsx(P,{className:"w-[130px]",children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(i,{value:"javascript",children:"JavaScript"}),e.jsx(i,{value:"typescript",children:"TypeScript"}),e.jsx(i,{value:"html",children:"HTML"}),e.jsx(i,{value:"python",children:"Python"}),e.jsx(i,{value:"sql",children:"SQL"})]})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Length:"}),e.jsxs(D,{value:d,onValueChange:s=>S(s),children:[e.jsx(P,{className:"w-[120px]",children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(i,{value:"short",children:"Short"}),e.jsx(i,{value:"medium",children:"Medium"}),e.jsx(i,{value:"long",children:"Long"})]})]})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:p?N:A,className:"gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"New ",t==="challenge"?"challenge":p?"snippet":"passage"]})]}),e.jsxs(ae,{className:p?"overflow-hidden border-0 bg-transparent shadow-none max-w-full":"max-w-full overflow-hidden",children:[e.jsx(re,{className:"pb-2",children:e.jsxs(ne,{className:"text-lg flex items-center justify-between flex-wrap gap-2",children:[e.jsx("span",{children:"Stats"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm font-normal text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),m?`${Math.floor(I/60)}:${String(Math.floor(I%60)).padStart(2,"0")}`:"0:00"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-4 w-4"}),z," WPM"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-4 w-4"}),R,"% accuracy"]})]})]})}),e.jsxs(le,{className:"space-y-4",children:[p?e.jsxs("div",{className:"relative ty-code-panel min-h-[220px] max-w-full p-4 font-mono text-sm leading-[1.7] overflow-auto cursor-text whitespace-pre-wrap break-words overflow-x-auto",onClick:()=>x.current?.focus(),children:[e.jsx("div",{className:"select-none break-words max-w-full min-w-0","aria-hidden":!0,style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:c.split("").map((s,a)=>{const r=l[a],o=r!==void 0?r===s:null,f=a===l.length;let j;return f?j="ty-syntax-cursor":o===!0?j="ty-syntax-correct":o===!1?j="ty-syntax-wrong":j=_[a]??"ty-syntax-default",e.jsx("span",{className:j,children:s===" "?" ":s},a)})}),e.jsx("textarea",{ref:x,value:l,onChange:s=>g(s.target.value),onKeyDown:K,className:"absolute inset-0 w-full h-full min-w-0 resize-none bg-transparent text-transparent caret-primary font-mono text-sm leading-[1.7] p-4 focus:outline-none break-words",style:{wordBreak:"break-word",overflowWrap:"anywhere",zIndex:1},spellCheck:!1,autoFocus:!0,readOnly:v,placeholder:"","aria-label":"Type the code above"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-[120px] max-w-full rounded-lg border bg-muted/30 p-4 font-mono text-lg leading-relaxed cursor-text overflow-hidden break-words",style:{wordBreak:"break-word",overflowWrap:"anywhere"},onClick:()=>x.current?.focus(),children:c.split("").map((s,a)=>{const r=l[a],o=r!==void 0?r===s:null,f=a===l.length;return e.jsx("span",{className:f?"bg-primary/30 text-primary border-b-2 border-primary animate-pulse":o===!0?"text-green-600 dark:text-green-400":o===!1?"text-red-600 dark:text-red-400 bg-red-500/10":"text-muted-foreground",children:s===" "?" ":s},a)})}),e.jsx("textarea",{ref:x,value:l,onChange:s=>g(s.target.value),onKeyDown:K,placeholder:"Start typing here...",className:"w-full min-h-[100px] max-w-full min-w-0 rounded-lg border bg-background px-4 py-3 font-mono text-lg leading-relaxed resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 box-border",spellCheck:!1,autoFocus:!0,readOnly:v})]}),v&&t==="challenge"&&e.jsxs("div",{className:"rounded-lg bg-primary/5 border border-primary/20 p-4 space-y-4",children:[e.jsx("p",{className:"font-semibold text-primary text-center",children:"Code Typing Challenge — Results"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{className:"rounded-md bg-muted/50 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Syntax accuracy"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[R,"%"]})]}),e.jsxs("div",{className:"rounded-md bg-muted/50 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Time to complete"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:m&&B?`${((B-m)/1e3).toFixed(1)}s`:"—"})]}),e.jsxs("div",{className:"rounded-md bg-muted/50 p-3 sm:col-span-2 sm:col-start-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"WPM"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:z})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-2",children:"Error heatmap"}),e.jsx("div",{className:"flex gap-0.5 h-8 rounded overflow-hidden bg-muted/30",children:O.map((s,a)=>e.jsx("div",{className:"flex-1 min-w-[4px] transition-colors",style:{backgroundColor:s===0?"hsl(var(--muted))":"hsl(var(--destructive))",opacity:s===0?.5:.3+s/X*.7},title:`Segment ${a+1}: ${s} error(s)`},a))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Red = more errors in that part of the snippet. Hover for count."})]}),e.jsx(y,{className:"w-full",onClick:N,children:"Next challenge"})]}),v&&t!=="challenge"&&e.jsxs("div",{className:"rounded-lg bg-primary/10 border border-primary/20 p-4 text-center",children:[e.jsx("p",{className:"font-semibold text-primary",children:"Done!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[z," WPM · ",R,"% accuracy"]}),e.jsx(y,{className:"mt-3",onClick:p?N:A,children:"Try again"})]})]})]})]})}),e.jsx(te,{})]})}export{Pe as default};
