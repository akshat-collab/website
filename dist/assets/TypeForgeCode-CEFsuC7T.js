import{r as n,j as e}from"./vendor-ui-CN8WKm1l.js";import{J as se,N as ne,O as re,g as J,Q as le,d as x}from"./index-gDkUcazU.js";import{S as oe,a as ae,b as ce,c as ie,d as w}from"./select-DoADUCMx.js";import{a as de,g as ue}from"./typingCodeSnippets-BbnfeOjw.js";import{M as fe,D as me,a as he,b as xe,c as pe}from"./dialog-0BOb-KT3.js";import{L as ge}from"./lock-Djmpukb2.js";import{C as W}from"./clock-BcG_Vx7t.js";import{Z as je}from"./zap-D4hAHzvK.js";import{R as ye}from"./rotate-ccw-DZQtxq7N.js";import"./vendor-react-Bte3Nn5F.js";const be={slow:1.2,moderate:1.8,fast:3.2,test:0},ve=[1,3,5,10];function we(c,p){let a=ue(c);return p==="slow"&&a.length>280?a=a.slice(0,280):p==="moderate"&&a.length>450?a=a.slice(0,450):p==="fast"&&a.length>600&&(a=a.slice(0,600)),a}function Fe(){const[c,p]=n.useState("slow"),[a,K]=n.useState(["slow"]),[R,Q]=n.useState("java"),[u,V]=n.useState(""),[l,T]=n.useState(""),[N,B]=n.useState(0),[i,F]=n.useState(null),[S,Z]=n.useState(5),[d,E]=n.useState(null),[f,g]=n.useState(!1),[m,P]=n.useState(!1),_=n.useRef(null),M=n.useRef(null),j=n.useRef(),h=n.useRef(0),D=n.useRef(!1),y=n.useRef([]),z=R==="java"?"javascript":R,b=n.useCallback(()=>{V(we(z,c)),T(""),B(0),F(null),E(null),g(!1),h.current=0,D.current=!1,y.current=[],setTimeout(()=>M.current?.focus(),100)},[z,c]);n.useEffect(()=>b(),[b]),n.useEffect(()=>{if(!m)return;const t=s=>{s.key==="Escape"&&P(!1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[m]);const v=(i?Date.now()-i:0)/1e3,A=be[c],I=c!=="test"&&i!==null,G=S*60,O=i!==null&&v>=G;n.useEffect(()=>{if(!I||d||f)return;const t=s=>{h.current===0&&(h.current=s);const r=(s-h.current)/1e3;h.current=s,B(o=>Math.min(u.length,o+A*r))};return j.current=requestAnimationFrame(s=>{h.current=s;const r=o=>{t(o),j.current=requestAnimationFrame(r)};j.current=requestAnimationFrame(r)}),()=>{j.current&&cancelAnimationFrame(j.current)}},[I,A,u.length,d,f]),n.useEffect(()=>{if(!(d||!i)){if(c!=="test"&&l.length>0){if(N-l.length>12){E("Cursor overtook you. Stay in sync!");return}if(l.length-N>8){E("Too far ahead. Match the cursor rhythm.");return}}O&&!D.current&&(D.current=!0,g(!0),K(t=>{const s=["slow","moderate","fast","test"],r=s.indexOf(c);if(r<0||r>=s.length-1)return t;const o=s[r+1];return t.includes(o)?t:[...t,o]}))}},[N,l.length,d,i,c,O]);const L=u.slice(0,l.length).split("").filter((t,s)=>t===l[s]).length,X=l.length-L,U=l.length>0?Math.round(L/l.length*100):100,q=i&&v>0?Math.round(L/5/(v/60)):0,$=n.useRef(0),H=n.useRef(0);$.current=l.length,H.current=u.slice(0,l.length).split("").filter((t,s)=>t===l[s]).length,n.useEffect(()=>{if(!i||f||d)return;const t=setInterval(()=>{const s=$.current,r=H.current,o=s>0?Math.round(r/s*100):100;y.current.push(o)},1e3);return()=>clearInterval(t)},[i,f,d]);const Y=t=>{if(t.key==="Tab"){t.preventDefault();const s=t.currentTarget,r=s.selectionStart??0,o=s.selectionEnd??r,C=l.slice(0,r)+"  "+l.slice(o);T(C),setTimeout(()=>s.setSelectionRange(r+2,r+2),0)}!i&&l.length===0&&u.length>0&&F(Date.now())},ee=u?de(u,z):[];return e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:28,marginBottom:4,color:"#e6edf3"},children:"Type Forge"}),e.jsx("p",{style:{color:"#8b949e",marginBottom:24},children:"Test your typing skills and practice here."}),e.jsx("div",{style:{height:1,background:"#1f2a36",marginBottom:24}}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:20,marginBottom:4,color:"#e6edf3"},children:"Code"}),e.jsx("p",{style:{color:"#8b949e",marginBottom:24},children:"Practice typing code with syntax highlighting. Timer starts on first key press."}),e.jsx("div",{style:{display:"flex",gap:40,borderBottom:"1px solid #1f2a36",marginBottom:16},children:["slow","moderate","fast","test"].map(t=>{const s=!a.includes(t),r=t==="slow"?"Slow":t==="moderate"?"Moderate":t==="fast"?"Fast":"Rapid",o=c===t;return e.jsx(se,{children:e.jsxs(ne,{children:[e.jsx(re,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>{s||p(t)},className:J("cursor-pointer transition-all duration-150 pb-2.5",s&&"cursor-not-allowed opacity-50"),style:{color:s?"#8b949e":o?"#2dd4ff":"#8b949e",fontWeight:500,borderBottom:o&&!s?"2px solid #2dd4ff":void 0},children:[s&&e.jsx(ge,{className:"h-3.5 w-3.5 inline mr-1.5"}),r]})}),e.jsx(le,{children:s?"Complete previous level to unlock":r})]})},t)})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16,color:"#8b949e",fontSize:14},children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(W,{className:"h-4 w-4"}),new Date().toLocaleTimeString("en-US",{hour12:!1})," ",new Date().toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"h-4 w-4"}),q," WPM"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-4 w-4"}),i?`${Math.floor(v/60)}:${String(Math.floor(v%60)).padStart(2,"0")}`:"00:00"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[U,"%"]})]})]}),e.jsx("div",{className:"flex gap-2 mb-4",children:ve.map(t=>e.jsxs(x,{variant:S===t?"default":"outline",size:"sm",style:S===t?{background:"#2dd4ff",color:"#0b0f14"}:{borderColor:"#1f2a36",color:"#8b949e"},className:S===t?"hover:opacity-90":"",onClick:()=>Z(t),children:[t," min"]},t))}),e.jsxs("div",{ref:_,className:J("overflow-hidden",m&&"fixed inset-0 z-50 rounded-none"),style:{background:m?"#0b0f14":"#0f141b",border:"1px solid #1f2a36",borderRadius:m?0:10,padding:16},children:[e.jsxs("div",{className:"flex items-center justify-between",style:{marginBottom:12,color:"#8b949e"},children:[e.jsxs(oe,{value:R,onValueChange:t=>Q(t),children:[e.jsx(ae,{className:"w-[120px] h-8 bg-transparent text-sm",style:{borderColor:"#1f2a36",color:"#8b949e"},children:e.jsx(ce,{})}),e.jsxs(ie,{children:[e.jsx(w,{value:"java",children:"Java"}),e.jsx(w,{value:"javascript",children:"JavaScript"}),e.jsx(w,{value:"python",children:"Python"}),e.jsx(w,{value:"sql",children:"SQL"}),e.jsx(w,{value:"html",children:"HTML"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",style:{color:"#8b949e"},children:[e.jsx("span",{style:{color:"#2dd4ff"},children:"Code"}),e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:b,children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>P(!m),children:e.jsx(fe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"relative min-h-[220px] p-4 font-mono text-sm leading-[1.7] cursor-text overflow-auto",onClick:()=>M.current?.focus(),children:[d&&e.jsxs("div",{className:"absolute inset-0 bg-red-500/10 flex items-center justify-center z-10 rounded-b-xl",children:[e.jsx("p",{className:"text-red-400 font-semibold",children:d}),e.jsx(x,{variant:"outline",size:"sm",className:"ml-4",onClick:b,children:"Retry"})]}),e.jsx("div",{className:"select-none break-all typeforge-code font-mono text-sm",style:{color:"#8b949e"},"aria-hidden":!0,children:u.split("").map((t,s)=>{const r=l[s],o=r!==void 0?r===t:null,C=c!=="test"&&Math.floor(N)===s;let k=ee[s]??"ty-syntax-default";C?k="border-l-2":o===!0?k="":o===!1&&(k="text-red-400 bg-red-500/20");const te=C?{background:"rgba(45, 212, 255, 0.2)",borderColor:"#2dd4ff",color:"#e6edf3"}:o===!0?{color:"#2dd4ff"}:{};return e.jsx("span",{className:k,style:te,children:t===" "?"Â ":t},s)})}),e.jsx("textarea",{ref:M,value:l,onChange:t=>T(t.target.value),onKeyDown:Y,className:"absolute inset-0 w-full h-full resize-none bg-transparent text-transparent font-mono text-sm leading-[1.7] p-4 focus:outline-none",style:{zIndex:1,caretColor:"#2dd4ff"},spellCheck:!1,readOnly:!!d||f,"aria-label":"Type the code"})]})]})]}),e.jsx(me,{open:f,onOpenChange:t=>!t&&g(!1),children:e.jsxs(he,{className:"text-[#e6edf3] max-w-md backdrop-blur-sm",style:{background:"#0f141b",border:"1px solid #1f2a36"},children:[e.jsx(xe,{children:e.jsx(pe,{style:{color:"#2dd4ff"},children:"Session Complete"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-4xl font-bold",style:{color:"#2dd4ff"},children:q}),e.jsx("p",{className:"text-sm",style:{color:"#8b949e"},children:"WPM"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-lg p-3",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{style:{color:"#8b949e"},children:"Accuracy"}),e.jsxs("p",{className:"text-lg font-semibold text-[#e6edf3]",children:[U,"%"]})]}),e.jsxs("div",{className:"rounded-lg p-3",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{style:{color:"#8b949e"},children:"Errors"}),e.jsx("p",{className:"text-lg font-semibold text-[#e6edf3]",children:X})]}),e.jsxs("div",{className:"rounded-lg p-3 col-span-2",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{style:{color:"#8b949e"},children:"Characters typed"}),e.jsx("p",{className:"text-lg font-semibold text-[#e6edf3]",children:l.length})]})]}),y.current.length>0&&e.jsxs("div",{className:"rounded-lg p-3",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-sm mb-2",style:{color:"#8b949e"},children:"Accuracy over time"}),e.jsx("div",{className:"h-20 w-full flex items-end gap-0.5",children:y.current.map((t,s)=>e.jsx("div",{className:"flex-1 min-w-0 rounded-t",style:{height:`${t}%`,background:"rgba(45, 212, 255, 0.6)"},title:`${t}%`},s))}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",style:{color:"#8b949e"},children:[e.jsx("span",{children:"0s"}),e.jsxs("span",{children:[y.current.length,"s"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(x,{className:"flex-1",style:{background:"#2dd4ff",color:"#0b0f14"},onClick:()=>{g(!1),b()},children:"Retry"}),e.jsx(x,{variant:"outline",style:{borderColor:"#1f2a36",color:"#8b949e"},onClick:()=>g(!1),children:"Close"})]})]})]})})]})}export{Fe as default};
